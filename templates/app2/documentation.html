{% extends 'base.html' %}
{% load static %}

{% block title %}Python Dasturlash Tili - Qo'llanma{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <!-- Sarlavha -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1 class="h2 text-gray-800">
                        <i class="fab fa-python text-primary me-2"></i>
                        Python Dasturlash Tili
                    </h1>
                    <p class="text-muted mb-0">Python sintaksisi, funksiyalari va misollar haqida to'liq qo'llanma</p>
                </div>
                <div>
                    <a href="{% url 'app2:code_practice' %}" class="btn btn-primary python-btn">
                        <i class="fas fa-arrow-left me-2"></i> Python Savollarga Qaytish
                    </a>
                </div>
            </div>

            <!-- Python versiyasi va ma'lumot -->
            <div class="alert alert-info mt-3 border-0" style="background-color: #e3f2fd;">
                <div class="d-flex align-items-center">
                    <i class="fab fa-python fa-2x me-3 text-primary"></i>
                    <div>
                        <h5 class="mb-1">Python {{ python.version }}</h5>
                        <p class="mb-0">{{ python.description }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Python asosiy ma'lumotlar -->
    <div class="row mb-4">
        <div class="col-md-8">
            <div class="card shadow border-0 h-100">
                <div class="card-header py-3 python-header">
                    <h6 class="m-0 font-weight-bold text-white">
                        <i class="fas fa-star me-2"></i>
                        Python Xususiyatlari
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        {% for feature in python.features %}
                        <div class="col-md-6 mb-3">
                            <div class="d-flex align-items-center">
                                <div class="symbol symbol-40 me-3">
                                    <div class="symbol-label bg-light-success">
                                        <i class="fas fa-check text-success"></i>
                                    </div>
                                </div>
                                <div>
                                    <h6 class="mb-1">{{ feature|safe }}</h6>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>

                    <!-- Python code misollari -->
                    <div class="mt-4">
                        <h6 class="text-primary mb-3">
                            <i class="fas fa-code me-2"></i>
                            Python Misol Kodlar
                        </h6>
                        <div class="row">
                            {% for example in python.examples %}
                            <div class="col-md-6 mb-3">
                                <div class="card border-0 bg-light h-100">
                                    <div class="card-body">
                                        <h6 class="card-title text-primary">{{ example.title }}</h6>
                                        <p class="small text-muted mb-2">{{ example.description }}</p>
                                        <pre class="python-code bg-dark text-light p-3 rounded"><code>{{ example.code }}</code></pre>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <!-- Python foydali resurslar -->
            <div class="card shadow border-0 mb-4">
                <div class="card-header py-3 bg-primary text-white border-0">
                    <h6 class="m-0 font-weight-bold">
                        <i class="fas fa-link me-2"></i>
                        Python Resurslar
                    </h6>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        {% for resource in python.resources %}
                        <li class="list-group-item border-0 px-0">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-external-link-alt text-primary me-3"></i>
                                <div>
                                    <a href="{{ resource.url }}" target="_blank" class="text-dark text-hover-primary">
                                        {{ resource.name }}
                                    </a>
                                    <div class="small text-muted">Python o'rganish uchun foydali manba</div>
                                </div>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>

            <!-- Python foydali funksiyalar -->
            <div class="card shadow border-0">
                <div class="card-header py-3 bg-success text-white border-0">
                    <h6 class="m-0 font-weight-bold">
                        <i class="fas fa-bolt me-2"></i>
                        Python Foydali Funksiyalar
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        {% for func in python.useful_functions %}
                        <div class="col-12 mb-2">
                            <div class="d-flex align-items-center">
                                <span class="badge bg-light-success text-success me-2">âœ“</span>
                                <span class="small">{{ func }}</span>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Python sintaksis bo'limlari -->
    <div class="row">
        <div class="col-12">
            <div class="card shadow border-0">
                <div class="card-header py-3 python-header">
                    <h6 class="m-0 font-weight-bold text-white">
                        <i class="fas fa-cogs me-2"></i>
                        Python Sintaksis Bo'limlari
                    </h6>
                </div>
                <div class="card-body">
                    <div class="accordion" id="pythonSyntax">
                        <!-- Asosiy Sintaksis -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#basics">
                                    <i class="fas fa-bolt me-2 text-warning"></i>
                                    Asosiy Sintaksis
                                </button>
                            </h2>
                            <div id="basics" class="accordion-collapse collapse show" data-bs-parent="#pythonSyntax">
                                <div class="accordion-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6 class="text-primary">O'zgaruvchilar</h6>
                                            <pre class="python-code bg-light p-3 rounded"><code># O'zgaruvchi yaratish
x = 10              # Integer
y = 3.14            # Float
name = "Python"     # String
is_active = True    # Boolean

# Ko'p o'zgaruvchi bir qatorda
a, b, c = 1, 2, 3

# O'zgaruvchi qiymatini o'zgartirish
counter = 0
counter = counter + 1  # counter += 1
counter += 1</code></pre>
                                        </div>
                                        <div class="col-md-6">
                                            <h6 class="text-primary">Input/Output</h6>
                                            <pre class="python-code bg-light p-3 rounded"><code># Input olish
name = input("Ismingizni kiriting: ")
age = int(input("Yoshingiz: "))

# Output (chop etish)
print("Salom,", name)
print(f"Siz {age} yoshdasiz")

# Formatlangan chiqish
print(f"{name} {age} yoshda")

# Ko'p qatorli chiqish
print("""Bu ko'p qatorli
matn chiqarish uchun
qulay usul""")</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Control Flow -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#controlFlow">
                                    <i class="fas fa-exchange-alt me-2 text-success"></i>
                                    Control Flow
                                </button>
                            </h2>
                            <div id="controlFlow" class="accordion-collapse collapse" data-bs-parent="#pythonSyntax">
                                <div class="accordion-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6 class="text-primary">If-Else-Elif</h6>
                                            <pre class="python-code bg-light p-3 rounded"><code># Oddiy if-else
age = 18
if age >= 18:
    print("Katta")
else:
    print("Kichik")

# Elif bilan
score = 85
if score >= 90:
    grade = "A"
elif score >= 80:
    grade = "B"
elif score >= 70:
    grade = "C"
else:
    grade = "F"

print(f"Bahoyingiz: {grade}")

# Ternary operator
status = "Katta" if age >= 18 else "Kichik"</code></pre>
                                        </div>
                                        <div class="col-md-6">
                                            <h6 class="text-primary">Tsikllar</h6>
                                            <pre class="python-code bg-light p-3 rounded"><code># For loop
for i in range(5):          # 0,1,2,3,4
    print(i)

for i in range(1, 6):      # 1,2,3,4,5
    print(i)

for i in range(1, 10, 2):  # 1,3,5,7,9
    print(i)

# While loop
counter = 0
while counter < 5:
    print(counter)
    counter += 1

# Break va Continue
for i in range(10):
    if i == 5:
        break
    if i % 2 == 0:
        continue
    print(i)</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Funksiyalar -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#functions">
                                    <i class="fas fa-function me-2 text-danger"></i>
                                    Funksiyalar
                                </button>
                            </h2>
                            <div id="functions" class="accordion-collapse collapse" data-bs-parent="#pythonSyntax">
                                <div class="accordion-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6 class="text-primary">Oddiy Funksiyalar</h6>
                                            <pre class="python-code bg-light p-3 rounded"><code># Funksiya yaratish
def greet(name):
    """Foydalanuvchiga salom berish"""
    return f"Salom, {name}!"

# Funksiyani chaqirish
result = greet("Ali")
print(result)

# Bir nechta parametr
def add(x, y):
    return x + y

sum_result = add(5, 3)  # 8

# Standart qiymat
def power(base, exponent=2):
    return base ** exponent

print(power(5))      # 25
print(power(5, 3))   # 125</code></pre>
                                        </div>
                                        <div class="col-md-6">
                                            <h6 class="text-primary">Lambda va *args</h6>
                                            <pre class="python-code bg-light p-3 rounded"><code># Lambda funksiyalar
square = lambda x: x ** 2
print(square(5))  # 25

# Lambda va map
numbers = [1, 2, 3, 4, 5]
squares = list(map(lambda x: x**2, numbers))

# *args - ko'p argumentlar
def sum_all(*args):
    return sum(args)

print(sum_all(1, 2, 3))        # 6
print(sum_all(1, 2, 3, 4, 5))  # 15

# **kwargs - keyword arguments
def print_info(**kwargs):
    for key, value in kwargs.items():
        print(f"{key}: {value}")

print_info(name="Ali", age=25, city="Tashkent")</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Ma'lumot Turlari -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#dataTypes">
                                    <i class="fas fa-database me-2 text-info"></i>
                                    Ma'lumot Turlari
                                </button>
                            </h2>
                            <div id="dataTypes" class="accordion-collapse collapse" data-bs-parent="#pythonSyntax">
                                <div class="accordion-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6 class="text-primary">List va Tuple</h6>
                                            <pre class="python-code bg-light p-3 rounded"><code># List (o'zgartirish mumkin)
fruits = ["olma", "banan", "gilos"]
fruits.append("uzum")
fruits.remove("banan")
fruits[0] = "anor"

# List methods
numbers = [1, 2, 3, 4, 5]
numbers.sort()
numbers.reverse()
len(numbers)  # 5
sum(numbers)  # 15

# Tuple (o'zgartirib bo'lmaydi)
colors = ("qizil", "yashil", "ko'k")
red, green, blue = colors  # unpacking

# List comprehension
squares = [x**2 for x in range(10)]
even_squares = [x**2 for x in range(10) if x % 2 == 0]</code></pre>
                                        </div>
                                        <div class="col-md-6">
                                            <h6 class="text-primary">Dict va Set</h6>
                                            <pre class="python-code bg-light p-3 rounded"><code># Dictionary (lug'at)
student = {
    "name": "Ali",
    "age": 20,
    "grade": "A"
}

# Lug'at bilan ishlash
student["city"] = "Tashkent"
age = student.get("age", 0)  # default qiymat

# Lug'at metodlari
keys = student.keys()
values = student.values()
items = student.items()

# Set (takrorlarsiz to'plam)
unique_numbers = {1, 2, 3, 3, 4, 4}  # {1, 2, 3, 4}
unique_numbers.add(5)
unique_numbers.remove(1)

# Set operations
set1 = {1, 2, 3}
set2 = {3, 4, 5}
union = set1 | set2      # {1,2,3,4,5}
intersection = set1 & set2 # {3}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Python test yozish bo'yicha qo'llanma -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card shadow border-0">
                <div class="card-header py-3 python-header">
                    <h6 class="m-0 font-weight-bold text-white">
                        <i class="fas fa-vial me-2"></i>
                        Python Test Kodini Qanday Yozish Kerak?
                    </h6>
                </div>
                <div class="card-body">
                    <div class="alert alert-success">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Muhim:</strong> Test kodi foydalanuvchi kodini to'g'ri tekshirishi kerak.
                        assert va print() funksiyalaridan foydalaning.
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="card border-success h-100">
                                <div class="card-header bg-success text-white">
                                    <h6 class="m-0">
                                        <i class="fas fa-check-circle me-2"></i>
                                        To'g'ri Yondashuv
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <pre class="python-code bg-dark text-light p-3 rounded"><code># Python: Faktorial funksiyasini test qilish

def test_factorial():
    """Foydalanuvchi factorial() funksiyasini test qilish"""

    # Test 1: Oddiy holat
    assert factorial(5) == 120, "5! = 120 bo'lishi kerak"

    # Test 2: 0 faktorial
    assert factorial(0) == 1, "0! = 1 bo'lishi kerak"

    # Test 3: 1 faktorial
    assert factorial(1) == 1, "1! = 1 bo'lishi kerak"

    # Test 4: Manfiy son uchun xato
    try:
        factorial(-5)
        print("XATO: Manfiy son uchun ValueError chiqishi kerak edi")
        return False
    except ValueError:
        print("âœ… Manfiy son uchun ValueError to'g'ri chiqdi")

    # Test 5: Matn uchun xato
    try:
        factorial("besh")
        print("XATO: String uchun TypeError chiqishi kerak edi")
        return False
    except TypeError:
        print("âœ… String uchun TypeError to'g'ri chiqdi")

    print("ðŸŽ‰ Barcha testlar muvaffaqiyatli o'tdi!")
    return True

# Testni ishga tushirish
test_factorial()</code></pre>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="card border-danger h-100">
                                <div class="card-header bg-danger text-white">
                                    <h6 class="m-0">
                                        <i class="fas fa-times-circle me-2"></i>
                                        Noto'g'ri Yondashuv
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <pre class="python-code bg-dark text-light p-3 rounded"><code># NOTO'G'RI: Test kodi qanday bo'lmasligi kerak

# 1. Input/Output ga bog'liq test
number = int(input("Son kiriting: "))  # Noto'g'ri
result = factorial(number)            # Foydalanuvchi kiritishiga bog'liq
print(f"Natija: {result}")

# 2. Aniq test yo'q
print("Funksiya ishlayapti...")       # Hech narsani tekshirmaydi
print("Testlar o'tdi deb hisoblaymiz") # Noto'g'ri

# 3. Xatolarni qayta ishlamaslik
factorial("string")  # Faqat TypeError chiqaradi, tekshirmaydi

# 4. Bitta test holati
if factorial(5) == 120:
    print("OK")       # Kam test holatlar
else:
    print("XATO")     # Xato haqida ma'lumot yo'q

# 5. Debug print'lar qoldirish
print("DEBUG: Bu yerga keldi")
print(f"Qiymat: {some_value}")  # Productionda bo'lmasligi kerak</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4">
                        <h6 class="text-primary mb-3">
                            <i class="fas fa-lightbulb me-2"></i>
                            Python Test Yozish Qoidalari
                        </h6>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="list-group">
                                    <div class="list-group-item border-0">
                                        <i class="fas fa-check text-success me-2"></i>
                                        <strong>assert</strong> dan foydalaning
                                    </div>
                                    <div class="list-group-item border-0">
                                        <i class="fas fa-check text-success me-2"></i>
                                        Har xil holatlarni tekshiring
                                    </div>
                                    <div class="list-group-item border-0">
                                        <i class="fas fa-check text-success me-2"></i>
                                        Xatolarni ham tekshiring (try/except)
                                    </div>
                                    <div class="list-group-item border-0">
                                        <i class="fas fa-check text-success me-2"></i>
                                        Test nomi mazmunli bo'lsin
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="list-group">
                                    <div class="list-group-item border-0">
                                        <i class="fas fa-check text-success me-2"></i>
                                        <strong>print()</strong> bilan natijani ko'rsating
                                    </div>
                                    <div class="list-group-item border-0">
                                        <i class="fas fa-check text-success me-2"></i>
                                        Test mustaqil ishlashi kerak
                                    </div>
                                    <div class="list-group-item border-0">
                                        <i class="fas fa-check text-success me-2"></i>
                                        Oddiy va aniq kod yozing
                                    </div>
                                    <div class="list-group-item border-0">
                                        <i class="fas fa-check text-success me-2"></i>
                                        Vaqt chegarasini hisobga oling
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
.python-header {
    background: linear-gradient(135deg, #3776AB 0%, #306998 100%);
    border-bottom: 3px solid #FFD43B;
}

.python-btn {
    background: linear-gradient(135deg, #3776AB 0%, #306998 100%);
    border: none;
}

.python-btn:hover {
    background: linear-gradient(135deg, #306998 0%, #265a82 100%);
}

.python-code {
    font-family: 'Monaco', 'Consolas', 'Courier New', monospace;
    font-size: 14px;
    line-height: 1.6;
}

.symbol {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 0.475rem;
}

.symbol-40 {
    width: 40px;
    height: 40px;
}

.symbol-label {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    border-radius: inherit;
}

.accordion-button:not(.collapsed) {
    background-color: rgba(55, 118, 171, 0.1);
    color: #3776AB;
}

.accordion-button:focus {
    border-color: #3776AB;
    box-shadow: 0 0 0 0.25rem rgba(55, 118, 171, 0.25);
}

.bg-light-success {
    background-color: rgba(40, 167, 69, 0.1) !important;
}

.list-group-item {
    padding: 0.5rem 0;
}
</style>
{% endblock %}

{% block extra_js %}
<script>
$(document).ready(function() {
    // Accordion faollashtirish
    $('#pythonSyntax .accordion-button').click(function() {
        $(this).find('i').toggleClass('fa-chevron-down fa-chevron-up');
    });

    // Python code highlight
    $('.python-code').each(function() {
        const code = $(this).text();
        // Soddalashtirilgan syntax highlighting
        $(this).html(code.replace(/(".*?")/g, '<span class="text-warning">$1</span>')
                        .replace(/(def|class|return|if|else|elif|for|while|try|except|assert|import|from|as)\b/g,
                                '<span class="text-primary fw-bold">$1</span>')
                        .replace(/(\d+)/g, '<span class="text-info">$1</span>')
                        .replace(/#.*$/gm, '<span class="text-success">$&</span>'));
    });

    // Copy code button
    $('.python-code').each(function(index) {
        const $code = $(this);
        const $pre = $code.parent();
        $pre.css('position', 'relative');

        const $button = $('<button>', {
            class: 'btn btn-sm btn-outline-secondary',
            style: 'position: absolute; top: 10px; right: 10px;',
            html: '<i class="fas fa-copy"></i>'
        }).appendTo($pre);

        $button.click(function() {
            const text = $code.text();
            navigator.clipboard.writeText(text).then(() => {
                $button.html('<i class="fas fa-check text-success"></i>');
                setTimeout(() => {
                    $button.html('<i class="fas fa-copy"></i>');
                }, 2000);
            });
        });
    });
});
</script>
{% endblock %}